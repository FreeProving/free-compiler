<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module contains smart constructors for nodes of the Coq AST.</span><span>
</span><a name="line-2"></a><span class="hs-comment">--   For convenience the original Coq AST is exported as well.</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Compiler.Coq.AST</span><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Coq.Gallina</span><span>
</span><a name="line-6"></a><span>    </span><span class="hs-comment">-- * Comments</span><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#comment"><span class="hs-identifier hs-var">comment</span></a><span>
</span><a name="line-8"></a><span>    </span><span class="hs-comment">-- * Proofs.</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#blankProof"><span class="hs-identifier hs-var">blankProof</span></a><span>
</span><a name="line-10"></a><span>    </span><span class="hs-comment">-- * Identifiers</span><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#ident"><span class="hs-identifier hs-var">ident</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier hs-var">bare</span></a><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#unpackQualid"><span class="hs-identifier hs-var">unpackQualid</span></a><span>
</span><a name="line-14"></a><span>    </span><span class="hs-comment">-- * Functions</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier hs-var">app</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#explicitApp"><span class="hs-identifier hs-var">explicitApp</span></a><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#arrows"><span class="hs-identifier hs-var">arrows</span></a><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#fun"><span class="hs-identifier hs-var">fun</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#inferredFun"><span class="hs-identifier hs-var">inferredFun</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-comment">-- * Binders</span><span>
</span><a name="line-21"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#typedBinder"><span class="hs-identifier hs-var">typedBinder</span></a><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#typedBinder%27"><span class="hs-identifier hs-var">typedBinder'</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-comment">-- * Assumptions</span><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#variable"><span class="hs-identifier hs-var">variable</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- * Definition sentences</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#definitionSentence"><span class="hs-identifier hs-var">definitionSentence</span></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-comment">-- * Types</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#sortType"><span class="hs-identifier hs-var">sortType</span></a><span>
</span><a name="line-29"></a><span>    </span><span class="hs-comment">-- * Expressions</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#string"><span class="hs-identifier hs-var">string</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#equation"><span class="hs-identifier hs-var">equation</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#match"><span class="hs-identifier hs-var">match</span></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#equals"><span class="hs-identifier hs-var">equals</span></a><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#notEquals"><span class="hs-identifier hs-var">notEquals</span></a><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#conj"><span class="hs-identifier hs-var">conj</span></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#disj"><span class="hs-identifier hs-var">disj</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-comment">-- * Imports</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#requireImportFrom"><span class="hs-identifier hs-var">requireImportFrom</span></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Coq.AST.html#requireExportFrom"><span class="hs-identifier hs-var">requireExportFrom</span></a><span>
</span><a name="line-40"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">where</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Composition</span><span>               </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.:</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.List.NonEmpty</span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">NonEmpty</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Text</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Language.Coq.Gallina</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Language.Coq.Gallina</span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">G</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- Comments                                                                  --</span><span>
</span><a name="line-51"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | Smart constructor for Coq comments.</span><span>
</span><a name="line-54"></a><span class="hs-identifier">comment</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Sentence</span><span>
</span><a name="line-55"></a><a name="comment"><a href="Compiler.Coq.AST.html#comment"><span class="hs-identifier">comment</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.CommentSentence</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">G.Comment</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-58"></a><span class="hs-comment">-- Proofs                                                                    --</span><span>
</span><a name="line-59"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-60"></a><span>
</span><a name="line-61"></a><span class="hs-comment">-- | An admitted proof that contains only a placeholder text.</span><span>
</span><a name="line-62"></a><span class="hs-identifier">blankProof</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Proof</span><span>
</span><a name="line-63"></a><a name="blankProof"><a href="Compiler.Coq.AST.html#blankProof"><span class="hs-identifier">blankProof</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.ProofAdmitted</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.pack</span><span> </span><span class="hs-string">&quot;  (* FILL IN HERE *)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- Identifiers                                                               --</span><span>
</span><a name="line-67"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- | Smart constructor for unqualified Coq identifiers.</span><span>
</span><a name="line-70"></a><span class="hs-identifier">ident</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Ident</span><span>
</span><a name="line-71"></a><a name="ident"><a href="Compiler.Coq.AST.html#ident"><span class="hs-identifier">ident</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">-- | Smart constructor for Coq identifiers.</span><span>
</span><a name="line-74"></a><span class="hs-identifier">bare</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Qualid</span><span>
</span><a name="line-75"></a><a name="bare"><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier">bare</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Bare</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Compiler.Coq.AST.html#ident"><span class="hs-identifier hs-var">ident</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Gets the identifier for the given unqualified Coq identifier. Returns</span><span>
</span><a name="line-78"></a><span class="hs-comment">--   @Nothing@ if the given identifier is qualified.</span><span>
</span><a name="line-79"></a><span class="hs-identifier">unpackQualid</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Qualid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-80"></a><a name="unpackQualid"><a href="Compiler.Coq.AST.html#unpackQualid"><span class="hs-identifier">unpackQualid</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Bare</span><span> </span><a name="local-6989586621679055126"><a href="#local-6989586621679055126"><span class="hs-identifier">text</span></a></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T.unpack</span><span> </span><a href="#local-6989586621679055126"><span class="hs-identifier hs-var">text</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span class="hs-identifier">unpackQualid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Qualified</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- Functions                                                                 --</span><span>
</span><a name="line-85"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-comment">-- | Smart constructor for the application of a Coq function or (type)</span><span>
</span><a name="line-88"></a><span class="hs-comment">--   constructor.</span><span>
</span><a name="line-89"></a><span class="hs-comment">--</span><span>
</span><a name="line-90"></a><span class="hs-comment">--   If the first argument is an application term, the arguments are added</span><span>
</span><a name="line-91"></a><span class="hs-comment">--   to that term. Otherwise a new application term is created.</span><span>
</span><a name="line-92"></a><span class="hs-identifier">app</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Term</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-93"></a><a name="app"><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier">app</span></a></a><span> </span><a name="local-6989586621679055127"><a href="#local-6989586621679055127"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679055127"><span class="hs-identifier hs-var">func</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">app</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.App</span><span> </span><a name="local-6989586621679055128"><a href="#local-6989586621679055128"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679055129"><a href="#local-6989586621679055129"><span class="hs-identifier">args</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679055130"><a href="#local-6989586621679055130"><span class="hs-identifier">args'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-identifier hs-var">G.App</span><span> </span><a href="#local-6989586621679055128"><span class="hs-identifier hs-var">func</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679055129"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">G.PosArg</span><span> </span><a href="#local-6989586621679055130"><span class="hs-identifier hs-var">args'</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-identifier">app</span><span> </span><a name="local-6989586621679055131"><a href="#local-6989586621679055131"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679055132"><a href="#local-6989586621679055132"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.App</span><span> </span><a href="#local-6989586621679055131"><span class="hs-identifier hs-var">func</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">G.PosArg</span><span> </span><a href="#local-6989586621679055132"><span class="hs-identifier hs-var">args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">-- | Smart constructor for the explicit application of a Coq function or</span><span>
</span><a name="line-99"></a><span class="hs-comment">--   constructor to otherwise inferred type arguments.</span><span>
</span><a name="line-100"></a><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span class="hs-comment">--   If there are no type arguments, no 'G.ExplicitApp' will be created.</span><span>
</span><a name="line-102"></a><span class="hs-identifier">explicitApp</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Qualid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Term</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-103"></a><a name="explicitApp"><a href="Compiler.Coq.AST.html#explicitApp"><span class="hs-identifier">explicitApp</span></a></a><span> </span><a name="local-6989586621679055133"><a href="#local-6989586621679055133"><span class="hs-identifier">qualid</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Qualid</span><span> </span><a href="#local-6989586621679055133"><span class="hs-identifier hs-var">qualid</span></a><span>
</span><a name="line-104"></a><span class="hs-identifier">explicitApp</span><span> </span><a name="local-6989586621679055134"><a href="#local-6989586621679055134"><span class="hs-identifier">qualid</span></a></a><span> </span><a name="local-6989586621679055135"><a href="#local-6989586621679055135"><span class="hs-identifier">typeArgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.ExplicitApp</span><span> </span><a href="#local-6989586621679055134"><span class="hs-identifier hs-var">qualid</span></a><span> </span><a href="#local-6989586621679055135"><span class="hs-identifier hs-var">typeArgs</span></a><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- | Smart constructor for a Coq function type.</span><span>
</span><a name="line-107"></a><span class="hs-identifier">arrows</span><span>
</span><a name="line-108"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Term</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The types of the function arguments.</span><span>
</span><a name="line-109"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>   </span><span class="hs-comment">-- ^ The return type of the function.</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-111"></a><a name="arrows"><a href="Compiler.Coq.AST.html#arrows"><span class="hs-identifier">arrows</span></a></a><span> </span><a name="local-6989586621679055136"><a href="#local-6989586621679055136"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679055137"><a href="#local-6989586621679055137"><span class="hs-identifier">returnType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-identifier hs-var">G.Arrow</span><span> </span><a href="#local-6989586621679055137"><span class="hs-identifier hs-var">returnType</span></a><span> </span><a href="#local-6989586621679055136"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-comment">-- | Smart constructor for the construction of a Coq lambda expression with</span><span>
</span><a name="line-114"></a><span class="hs-comment">--   the given arguments and right hand side.</span><span>
</span><a name="line-115"></a><span class="hs-comment">--</span><span>
</span><a name="line-116"></a><span class="hs-comment">--   The second argument contains the types of the arguments are inferred</span><span>
</span><a name="line-117"></a><span class="hs-comment">--   by Coq.</span><span>
</span><a name="line-118"></a><span class="hs-identifier">fun</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Qualid</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-119"></a><a name="fun"><a href="Compiler.Coq.AST.html#fun"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679056281"><a href="#local-6989586621679056281"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679056282"><a href="#local-6989586621679056282"><span class="hs-identifier">argTypes</span></a></a><span> </span><a name="local-6989586621679056283"><a href="#local-6989586621679056283"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Fun</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><a href="#local-6989586621679056285"><span class="hs-identifier hs-var">binders</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056283"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-120"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-identifier">argNames</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Name</span><span class="hs-special">]</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-6989586621679056284"><a href="#local-6989586621679056284"><span class="hs-identifier">argNames</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">G.Ident</span><span> </span><a href="#local-6989586621679056281"><span class="hs-identifier hs-var">args</span></a><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>  </span><span class="hs-identifier">binders</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Binder</span><span class="hs-special">]</span><span>
</span><a name="line-125"></a><span>  </span><a name="local-6989586621679056285"><a href="#local-6989586621679056285"><span class="hs-identifier">binders</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zipWith</span><span> </span><a href="#local-6989586621679056286"><span class="hs-identifier hs-var">makeBinder</span></a><span> </span><a href="#local-6989586621679056282"><span class="hs-identifier hs-var">argTypes</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056284"><span class="hs-identifier hs-var">argNames</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span>  </span><span class="hs-identifier">makeBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Binder</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-6989586621679056286"><a href="#local-6989586621679056286"><span class="hs-identifier">makeBinder</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Inferred</span><span> </span><span class="hs-identifier hs-var">G.Explicit</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-identifier">makeBinder</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679056460"><a href="#local-6989586621679056460"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Typed</span><span> </span><span class="hs-identifier hs-var">G.Ungeneralizable</span><span> </span><span class="hs-identifier hs-var">G.Explicit</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679056460"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | Like 'fun', but all argument types are inferred.</span><span>
</span><a name="line-132"></a><span class="hs-identifier">inferredFun</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Qualid</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-133"></a><a name="inferredFun"><a href="Compiler.Coq.AST.html#inferredFun"><span class="hs-identifier">inferredFun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Compiler.Coq.AST.html#fun"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- Binders                                                                   --</span><span>
</span><a name="line-137"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-comment">-- | Smart constructor for an explicit or implicit typed Coq binder.</span><span>
</span><a name="line-140"></a><span class="hs-identifier">typedBinder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Explicitness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Qualid</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Binder</span><span>
</span><a name="line-141"></a><a name="typedBinder"><a href="Compiler.Coq.AST.html#typedBinder"><span class="hs-identifier">typedBinder</span></a></a><span> </span><a name="local-6989586621679056461"><a href="#local-6989586621679056461"><span class="hs-identifier">explicitness</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>  </span><span class="hs-identifier hs-var">G.Typed</span><span> </span><span class="hs-identifier hs-var">G.Ungeneralizable</span><span> </span><a href="#local-6989586621679056461"><span class="hs-identifier hs-var">explicitness</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">G.Ident</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | Like 'typedBinder' but for a single identifier.</span><span>
</span><a name="line-145"></a><span class="hs-identifier">typedBinder'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Explicitness</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Qualid</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Binder</span><span>
</span><a name="line-146"></a><a name="typedBinder%27"><a href="Compiler.Coq.AST.html#typedBinder%27"><span class="hs-identifier">typedBinder'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Compiler.Coq.AST.html#typedBinder"><span class="hs-identifier hs-var">typedBinder</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-149"></a><span class="hs-comment">-- Assumptions                                                               --</span><span>
</span><a name="line-150"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Generates a @Variable@ assumption sentence.</span><span>
</span><a name="line-153"></a><span class="hs-identifier">variable</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Qualid</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Sentence</span><span>
</span><a name="line-154"></a><a name="variable"><a href="Compiler.Coq.AST.html#variable"><span class="hs-identifier">variable</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-155"></a><span>  </span><span class="hs-identifier hs-var">G.AssumptionSentence</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">G.Assumption</span><span> </span><span class="hs-identifier hs-var">G.Variable</span><span> </span><span class="hs-operator hs-var">.:</span><span> </span><span class="hs-identifier hs-var">G.Assums</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- Definition sentences                                                      --</span><span>
</span><a name="line-159"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Smart constructor for a Coq definition sentence.</span><span>
</span><a name="line-162"></a><span class="hs-identifier">definitionSentence</span><span>
</span><a name="line-163"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Qualid</span><span>     </span><span class="hs-comment">-- ^ The name of the definition.</span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Binder</span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Binders for the parameters of the definition.</span><span>
</span><a name="line-165"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-comment">-- ^ The return type of the definition.</span><span>
</span><a name="line-166"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>       </span><span class="hs-comment">-- ^ The right hand side of the definition.</span><span>
</span><a name="line-167"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Sentence</span><span>
</span><a name="line-168"></a><a name="definitionSentence"><a href="Compiler.Coq.AST.html#definitionSentence"><span class="hs-identifier">definitionSentence</span></a></a><span> </span><a name="local-6989586621679056462"><a href="#local-6989586621679056462"><span class="hs-identifier">qualid</span></a></a><span> </span><a name="local-6989586621679056463"><a href="#local-6989586621679056463"><span class="hs-identifier">binders</span></a></a><span> </span><a name="local-6989586621679056464"><a href="#local-6989586621679056464"><span class="hs-identifier">returnType</span></a></a><span> </span><a name="local-6989586621679056465"><a href="#local-6989586621679056465"><span class="hs-identifier">term</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-169"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.DefinitionSentence</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.DefinitionDef</span><span> </span><span class="hs-identifier hs-var">G.Global</span><span> </span><a href="#local-6989586621679056462"><span class="hs-identifier hs-var">qualid</span></a><span> </span><a href="#local-6989586621679056463"><span class="hs-identifier hs-var">binders</span></a><span> </span><a href="#local-6989586621679056464"><span class="hs-identifier hs-var">returnType</span></a><span> </span><a href="#local-6989586621679056465"><span class="hs-identifier hs-var">term</span></a><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>
</span><a name="line-173"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- Types                                                                     --</span><span>
</span><a name="line-175"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">-- | The type of a type variable.</span><span>
</span><a name="line-178"></a><span class="hs-identifier">sortType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-179"></a><a name="sortType"><a href="Compiler.Coq.AST.html#sortType"><span class="hs-identifier">sortType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Sort</span><span> </span><span class="hs-identifier hs-var">G.Type</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- Expressions                                                              --</span><span>
</span><a name="line-183"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | Smart constructor for Coq string literals.</span><span>
</span><a name="line-186"></a><span class="hs-identifier">string</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-187"></a><a name="string"><a href="Compiler.Coq.AST.html#string"><span class="hs-identifier">string</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.String</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">T.pack</span><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | Smart constructor for Coq equations for @match@ expressions.</span><span>
</span><a name="line-190"></a><span class="hs-identifier">equation</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Pattern</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Equation</span><span>
</span><a name="line-191"></a><a name="equation"><a href="Compiler.Coq.AST.html#equation"><span class="hs-identifier">equation</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Equation</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">G.MultPattern</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Smart constructor for a Coq @match@ expression.</span><span>
</span><a name="line-194"></a><span class="hs-identifier">match</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.Equation</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-195"></a><a name="match"><a href="Compiler.Coq.AST.html#match"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679056466"><a href="#local-6989586621679056466"><span class="hs-identifier">value</span></a></a><span> </span><a name="local-6989586621679056467"><a href="#local-6989586621679056467"><span class="hs-identifier">eqns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.Match</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679056468"><span class="hs-identifier hs-var">item</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><a href="#local-6989586621679056467"><span class="hs-identifier hs-var">eqns</span></a><span>
</span><a name="line-196"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-197"></a><span>  </span><span class="hs-identifier">item</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.MatchItem</span><span>
</span><a name="line-198"></a><span>  </span><a name="local-6989586621679056468"><a href="#local-6989586621679056468"><span class="hs-identifier">item</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.MatchItem</span><span> </span><a href="#local-6989586621679056466"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | Smart constructor for reflexive equality in Coq.</span><span>
</span><a name="line-201"></a><span class="hs-identifier">equals</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-202"></a><a name="equals"><a href="Compiler.Coq.AST.html#equals"><span class="hs-identifier">equals</span></a></a><span> </span><a name="local-6989586621679056469"><a href="#local-6989586621679056469"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679056470"><a href="#local-6989586621679056470"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier hs-var">app</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Qualid</span><span> </span><span class="hs-special">(</span><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier hs-var">bare</span></a><span> </span><span class="hs-string">&quot;op_=__&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679056469"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056470"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">-- | Smart constructor for reflexive inequality in Coq.</span><span>
</span><a name="line-205"></a><span class="hs-identifier">notEquals</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-206"></a><a name="notEquals"><a href="Compiler.Coq.AST.html#notEquals"><span class="hs-identifier">notEquals</span></a></a><span> </span><a name="local-6989586621679056471"><a href="#local-6989586621679056471"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679056472"><a href="#local-6989586621679056472"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier hs-var">app</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Qualid</span><span> </span><span class="hs-special">(</span><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier hs-var">bare</span></a><span> </span><span class="hs-string">&quot;op_&lt;&gt;__&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679056471"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056472"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- | Smart constructor for a conjunction in Coq.</span><span>
</span><a name="line-209"></a><span class="hs-identifier">conj</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-210"></a><a name="conj"><a href="Compiler.Coq.AST.html#conj"><span class="hs-identifier">conj</span></a></a><span> </span><a name="local-6989586621679056473"><a href="#local-6989586621679056473"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679056474"><a href="#local-6989586621679056474"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier hs-var">app</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Qualid</span><span> </span><span class="hs-special">(</span><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier hs-var">bare</span></a><span> </span><span class="hs-string">&quot;op_/\\__&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679056473"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056474"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Smart constructor for a disjunction in Coq.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">disj</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Term</span><span>
</span><a name="line-214"></a><a name="disj"><a href="Compiler.Coq.AST.html#disj"><span class="hs-identifier">disj</span></a></a><span> </span><a name="local-6989586621679056475"><a href="#local-6989586621679056475"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679056476"><a href="#local-6989586621679056476"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Coq.AST.html#app"><span class="hs-identifier hs-var">app</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Qualid</span><span> </span><span class="hs-special">(</span><a href="Compiler.Coq.AST.html#bare"><span class="hs-identifier hs-var">bare</span></a><span> </span><span class="hs-string">&quot;op_\\/__&quot;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679056475"><span class="hs-identifier hs-var">t1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056476"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">]</span><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-217"></a><span class="hs-comment">-- Imports                                                                   --</span><span>
</span><a name="line-218"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span class="hs-comment">-- | Creates a @From ... Require Import ...@ sentence.</span><span>
</span><a name="line-221"></a><span class="hs-identifier">requireImportFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.ModuleIdent</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.ModuleIdent</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Sentence</span><span>
</span><a name="line-222"></a><a name="requireImportFrom"><a href="Compiler.Coq.AST.html#requireImportFrom"><span class="hs-identifier">requireImportFrom</span></a></a><span> </span><a name="local-6989586621679056477"><a href="#local-6989586621679056477"><span class="hs-identifier">library</span></a></a><span> </span><a name="local-6989586621679056478"><a href="#local-6989586621679056478"><span class="hs-identifier">modules</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.ModuleSentence</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Require</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679056477"><span class="hs-identifier hs-var">library</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">G.Import</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><a href="#local-6989586621679056478"><span class="hs-identifier hs-var">modules</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | Creates a @From ... Require Import ...@ sentence.</span><span>
</span><a name="line-226"></a><span class="hs-identifier">requireExportFrom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G.ModuleIdent</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">G.ModuleIdent</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">G.Sentence</span><span>
</span><a name="line-227"></a><a name="requireExportFrom"><a href="Compiler.Coq.AST.html#requireExportFrom"><span class="hs-identifier">requireExportFrom</span></a></a><span> </span><a name="local-6989586621679056479"><a href="#local-6989586621679056479"><span class="hs-identifier">library</span></a></a><span> </span><a name="local-6989586621679056480"><a href="#local-6989586621679056480"><span class="hs-identifier">modules</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">G.ModuleSentence</span><span>
</span><a name="line-228"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">G.Require</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679056479"><span class="hs-identifier hs-var">library</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-identifier hs-var">G.Export</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">NonEmpty.fromList</span><span> </span><a href="#local-6989586621679056480"><span class="hs-identifier hs-var">modules</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-229"></a></pre></body></html>