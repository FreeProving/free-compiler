<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>FreeC.Pass.EtaConversionPass</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/FreeC.Pass.EtaConversionPass.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">free-compiler-0.1.0.0: A Haskell to Coq compiler.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">FreeC.Pass.EtaConversionPass</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Testing interface</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains a compiler pass that applies &#951;-conversions to
   expressions such that all function and constructor applications are
   fully applied.</p><p>An &#951;-conversion is the conversion of a partially applied function
   expression <code>f</code> to a lambda expression <code>\x -&gt; f x</code> that explicitly
   applies the missing argument.</p><h1>Motivation</h1><p>We have to perform &#951;-conversions due to an optimization of the monadic
   translation of function declarations.
   An <code>n</code>-ary function declaration of type <code>&#964;&#8321; -&gt; &#8230; -&gt; &#964;&#8345; -&gt; &#964;</code> is translated
   to a function declaration of type <code>&#964;&#8321;' -&gt; &#8230; -&gt; &#964;&#8345;' -&gt; &#964;'</code> where <code>&#964;&#7522;'</code> is
   the translation of type <code>&#964;&#7522;</code>. However, an <code>n</code>-ary lambda abstraction of
   the same type is translated to <code>m (&#964;&#8321;' -&gt; (&#964;&#8322; -&gt; &#8230; -&gt; &#964;&#8345; -&gt; &#964;)')</code> where
   <code>m</code> is the target monad. That only the arguments but not the intermediate
   results of function declarations are lifted to the monad, improves the
   readability of generated function applications. Intermediate results don't
   have to be bound since we know that partial applications cannot have an
   effect.
   This optimization does not work when functions are applied only partially.
   Thus, we have to convert partial applications to full applications.</p><h1>Specification</h1><h2>Preconditions</h2><p>The arity of all constructors and functions must be known (i.e., there
   must be corresponding environment entries).</p><h2>Translation</h2><p>On the right-hand sides of function declarations, all of the largest
   sub-expressions of the form</p><pre>  f <code>&#945;&#8321; &#8230; </code>&#945;&#8346; e&#8321; &#8230; e&#8344;
  </pre><p>where <code>f</code> is the name of an <code>n</code>-ary constructor or function declaration
   and <code>m &lt; n</code> is replaced by a lambda abstraction</p><pre>  \x&#8333;&#8344;&#8330;&#8321;&#8334; &#8230; x&#8345; -&gt; f <code>&#945;&#8321; &#8230; </code>&#945;&#8346; e&#8321; &#8230; e&#8344; x&#8333;&#8344;&#8330;&#8321;&#8334; &#8230; x&#8345;
  </pre><p>where <code>x&#8333;&#8344;&#8330;&#8321;&#8334; &#8230; x&#8345;</code> are <code>n-m</code> fresh variables.</p><h2>Postconditions</h2><p>All applications of <code>n</code>-ary functions or constructors have at least <code>n</code>
   arguments.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:etaConversionPass">etaConversionPass</a> :: <a href="FreeC-Pass.html#t:Pass" title="FreeC.Pass">Pass</a> <a href="FreeC-IR-Syntax-Module.html#t:Module" title="FreeC.IR.Syntax.Module">Module</a></li><li class="src short"><a href="#v:etaConvertExpr">etaConvertExpr</a> :: <a href="FreeC-IR-Syntax-Expr.html#t:Expr" title="FreeC.IR.Syntax.Expr">Expr</a> -&gt; <a href="FreeC-Monad-Converter.html#t:Converter" title="FreeC.Monad.Converter">Converter</a> <a href="FreeC-IR-Syntax-Expr.html#t:Expr" title="FreeC.IR.Syntax.Expr">Expr</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:etaConversionPass" class="def">etaConversionPass</a> :: <a href="FreeC-Pass.html#t:Pass" title="FreeC.Pass">Pass</a> <a href="FreeC-IR-Syntax-Module.html#t:Module" title="FreeC.IR.Syntax.Module">Module</a> <a href="src/FreeC.Pass.EtaConversionPass.html#etaConversionPass" class="link">Source</a> <a href="#v:etaConversionPass" class="selflink">#</a></p><div class="doc"><p>Applies &#951;-conversions to the right-hand sides of all function declarations
   in the given module until all function and constructor applications are
   fully applied.</p></div></div><a href="#g:1" id="g:1"><h1>Testing interface</h1></a><div class="top"><p class="src"><a id="v:etaConvertExpr" class="def">etaConvertExpr</a> :: <a href="FreeC-IR-Syntax-Expr.html#t:Expr" title="FreeC.IR.Syntax.Expr">Expr</a> -&gt; <a href="FreeC-Monad-Converter.html#t:Converter" title="FreeC.Monad.Converter">Converter</a> <a href="FreeC-IR-Syntax-Expr.html#t:Expr" title="FreeC.IR.Syntax.Expr">Expr</a> <a href="src/FreeC.Pass.EtaConversionPass.html#etaConvertExpr" class="link">Source</a> <a href="#v:etaConvertExpr" class="selflink">#</a></p><div class="doc"><p>Applies &#951;-conversions to the given expression and it's sub-expressions
   until all function and constructor applications are fully applied.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>