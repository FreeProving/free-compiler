<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module contains the definition of type expressions of our</span><span>
</span><a name="line-2"></a><span class="hs-comment">--   lifted intermediate language.</span><span>
</span><a name="line-3"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">FreeC.LiftedIR.Syntax.Type</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span>           </span><a href="FreeC.IR.SrcSpan.html"><span class="hs-identifier">FreeC.IR.SrcSpan</span></a><span>           </span><span class="hs-special">(</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span>           </span><a href="FreeC.LiftedIR.Syntax.Name.html"><span class="hs-identifier">FreeC.LiftedIR.Syntax.Name</span></a><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- | A type expression.</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">--   Types are represented as fully applied type constructors or type variables</span><span>
</span><a name="line-11"></a><span class="hs-comment">--   of kind @*@. In contrast to the 'FreeC.IR.Type' from the intermediate</span><span>
</span><a name="line-12"></a><span class="hs-comment">--   representation, @Free@ is modelled explicitly.</span><span>
</span><a name="line-13"></a><span class="hs-keyword">data</span><span> </span><a name="Type"><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier">Type</span></a></a><span>
</span><a name="line-14"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | A type variable.</span><span>
</span><a name="line-15"></a><span>    </span><a name="TypeVar"><a href="FreeC.LiftedIR.Syntax.Type.html#TypeVar"><span class="hs-identifier">TypeVar</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="typeSrcSpan"><a href="FreeC.LiftedIR.Syntax.Type.html#typeSrcSpan"><span class="hs-identifier">typeSrcSpan</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a name="typeVarIdent"><a href="FreeC.LiftedIR.Syntax.Type.html#typeVarIdent"><span class="hs-identifier">typeVarIdent</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.Syntax.Name.html#TypeVarIdent"><span class="hs-identifier hs-type">TypeVarIdent</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-comment">-- | A fully applied n-ary type constructor application.</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="TypeCon"><a href="FreeC.LiftedIR.Syntax.Type.html#TypeCon"><span class="hs-identifier">TypeCon</span></a></a><span>
</span><a name="line-18"></a><span>      </span><span class="hs-special">{</span><span> </span><a name="typeSrcSpan"><a href="FreeC.LiftedIR.Syntax.Type.html#typeSrcSpan"><span class="hs-identifier">typeSrcSpan</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-19"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="typeConName"><a href="FreeC.LiftedIR.Syntax.Type.html#typeConName"><span class="hs-identifier">typeConName</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.Syntax.Name.html#TypeConName"><span class="hs-identifier hs-type">TypeConName</span></a><span>
</span><a name="line-20"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="typeConArgs"><a href="FreeC.LiftedIR.Syntax.Type.html#typeConArgs"><span class="hs-identifier">typeConArgs</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span>
</span><a name="line-21"></a><span>      </span><span class="hs-special">,</span><span> </span><a name="typeIsDec"><a href="FreeC.LiftedIR.Syntax.Type.html#typeIsDec"><span class="hs-identifier">typeIsDec</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-22"></a><span>        </span><span class="hs-comment">-- ^ Marks this type as a decreasing element of a type signature.</span><span>
</span><a name="line-23"></a><span>        </span><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span>        </span><span class="hs-comment">--   E.g., recursive constructor arguments or decreasing function</span><span>
</span><a name="line-25"></a><span>        </span><span class="hs-comment">--   argument. This field is used by the Agda back end to place sized</span><span>
</span><a name="line-26"></a><span>        </span><span class="hs-comment">--   type annotations.</span><span>
</span><a name="line-27"></a><span>      </span><span class="hs-special">}</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-comment">-- | A function type.</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FuncType"><a href="FreeC.LiftedIR.Syntax.Type.html#FuncType"><span class="hs-identifier">FuncType</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="typeSrcSpan"><a href="FreeC.LiftedIR.Syntax.Type.html#typeSrcSpan"><span class="hs-identifier">typeSrcSpan</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span>
</span><a name="line-30"></a><span>             </span><span class="hs-special">,</span><span> </span><a name="funcTypeArg"><a href="FreeC.LiftedIR.Syntax.Type.html#funcTypeArg"><span class="hs-identifier">funcTypeArg</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-31"></a><span>             </span><span class="hs-special">,</span><span> </span><a name="funcTypeRes"><a href="FreeC.LiftedIR.Syntax.Type.html#funcTypeRes"><span class="hs-identifier">funcTypeRes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-32"></a><span>             </span><span class="hs-special">}</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-comment">-- | A type constructor for the free monad.</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="FreeTypeCon"><a href="FreeC.LiftedIR.Syntax.Type.html#FreeTypeCon"><span class="hs-identifier">FreeTypeCon</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="typeSrcSpan"><a href="FreeC.LiftedIR.Syntax.Type.html#typeSrcSpan"><span class="hs-identifier">typeSrcSpan</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span class="hs-special">,</span><span> </span><a name="typeFreeArg"><a href="FreeC.LiftedIR.Syntax.Type.html#typeFreeArg"><span class="hs-identifier">typeFreeArg</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-35"></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- Utility                                                                   --</span><span>
</span><a name="line-39"></a><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- | Creates a function type with the given argument and return types.</span><span>
</span><a name="line-41"></a><span class="hs-identifier">funcType</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.IR.SrcSpan.html#SrcSpan"><span class="hs-identifier hs-type">SrcSpan</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-42"></a><a name="funcType"><a href="FreeC.LiftedIR.Syntax.Type.html#funcType"><span class="hs-identifier">funcType</span></a></a><span> </span><a name="local-6989586621679081637"><a href="#local-6989586621679081637"><span class="hs-identifier">srcSpan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><a href="FreeC.LiftedIR.Syntax.Type.html#FuncType"><span class="hs-identifier hs-var">FuncType</span></a><span> </span><a href="#local-6989586621679081637"><span class="hs-identifier hs-var">srcSpan</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">-- | Decides whether a type contains a decreasing argument.</span><span>
</span><a name="line-45"></a><span class="hs-identifier">decreasing</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-46"></a><a name="decreasing"><a href="FreeC.LiftedIR.Syntax.Type.html#decreasing"><span class="hs-identifier">decreasing</span></a></a><span> </span><span class="hs-special">(</span><a href="FreeC.LiftedIR.Syntax.Type.html#TypeCon"><span class="hs-identifier hs-var">TypeCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679081638"><a href="#local-6989586621679081638"><span class="hs-identifier">dec</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081638"><span class="hs-identifier hs-var">dec</span></a><span>
</span><a name="line-47"></a><span class="hs-identifier">decreasing</span><span> </span><span class="hs-special">(</span><a href="FreeC.LiftedIR.Syntax.Type.html#FuncType"><span class="hs-identifier hs-var">FuncType</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679081639"><a href="#local-6989586621679081639"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679081640"><a href="#local-6989586621679081640"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#decreasing"><span class="hs-identifier hs-var">decreasing</span></a><span> </span><a href="#local-6989586621679081639"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#decreasing"><span class="hs-identifier hs-var">decreasing</span></a><span> </span><a href="#local-6989586621679081640"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-48"></a><span class="hs-identifier">decreasing</span><span> </span><span class="hs-special">(</span><a href="FreeC.LiftedIR.Syntax.Type.html#FreeTypeCon"><span class="hs-identifier hs-var">FreeTypeCon</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679081641"><a href="#local-6989586621679081641"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="FreeC.LiftedIR.Syntax.Type.html#decreasing"><span class="hs-identifier hs-var">decreasing</span></a><span> </span><a href="#local-6989586621679081641"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-49"></a><span class="hs-identifier">decreasing</span><span> </span><span class="hs-special">(</span><a href="FreeC.LiftedIR.Syntax.Type.html#TypeVar"><span class="hs-identifier hs-var">TypeVar</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-50"></a></pre></body></html>